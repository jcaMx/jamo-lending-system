import{c as pe,r as c,j as t,a as xe,H as ye}from"./app-0d3sklFQ.js";import{A as ge}from"./app-layout-BUlHJEIw.js";import{S as je}from"./search-Bk5A5NOi.js";import"./app-DFC8ppuA.js";import"./button-BT8l82O1.js";import"./utils-CFcDjcb_.js";import"./sheet-KTeoO0_X.js";import"./index-CSfBvJPP.js";import"./index-DCpgsalv.js";import"./index-CIAlwk6f.js";import"./createLucideIcon-292lA348.js";import"./index-BpvsPxZt.js";import"./index-sJV3ACG6.js";import"./index-D_fJ_aXj.js";import"./routes-B8UsKWZ0.js";import"./app-logo-icon-BxrI132f.js";const Se=[{title:"Repayments",href:"/repayments/add"}];function He(C){const e=pe.c(76),{borrowers:ee,collectors:ue}=C,[o,te]=c.useState(""),[d,ae]=c.useState(null),[n,ne]=c.useState(""),[s,ce]=c.useState(""),[i,ie]=c.useState(""),[m,me]=c.useState(""),[a,de]=c.useState("");let B;e[0]===Symbol.for("react.memo_cache_sentinel")?(B=[],e[0]=B):B=e[0];const[le,fe]=c.useState(B),[k,he]=c.useState("");let R;if(e[1]!==ee||e[2]!==o){let l;e[4]!==o?(l=r=>r.name.toLowerCase().includes(o.toLowerCase()),e[4]=o,e[5]=l):l=e[5],R=ee.filter(l),e[1]=ee,e[2]=o,e[3]=R}else R=e[3];const A=R,u=ue;let F;e[6]===Symbol.for("react.memo_cache_sentinel")?(F=l=>{ae(l),te(l.name)},e[6]=F):F=e[6];const be=F;let P;e[7]!==n||e[8]!==i||e[9]!==m||e[10]!==u||e[11]!==s||e[12]!==a||e[13]!==d||e[14]!==le?(P=l=>{if(l.preventDefault(),!d)return alert("Please select a borrower.");if(!i)return alert("Please select a collector.");if(!n||Number(n)<=0)return alert("Please enter a valid amount.");if(Number(n)>1e7)return alert("Amount cannot exceed 10,000,000.");if(!s)return alert("Please select a payment method.");if(!m)return alert("Please select a collection date.");if(a&&le.includes(a))return alert("This reference number has already been used.");const r=u.find(oe=>String(oe.id)===String(i));if(!r)return alert("Collector not found");xe.post("/repayments/store",{borrower_id:d.id,loanNo:d.loanNo,amount:n,method:s,collectedBy:r?.id,collectionDate:m,referenceNumber:a||null}),a&&fe(oe=>[...oe,a]),he("Payment submitted successfully!"),ae(null),te(""),ne(""),ce(""),ie(""),me(""),de("")},e[7]=n,e[8]=i,e[9]=m,e[10]=u,e[11]=s,e[12]=a,e[13]=d,e[14]=le,e[15]=P):P=e[15];const se=P;let E;e[16]===Symbol.for("react.memo_cache_sentinel")?(E=t.jsx(ye,{title:"Add Repayment"}),e[16]=E):E=e[16];let D;e[17]===Symbol.for("react.memo_cache_sentinel")?(D=t.jsx("div",{className:"border-b-4 border-[#FABF24] rounded-t-lg pb-3 mb-6 bg-[#FFF8E2] p-5",children:t.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Repayment"})}),e[17]=D):D=e[17];let L;e[18]===Symbol.for("react.memo_cache_sentinel")?(L=t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Borrower"}),e[18]=L):L=e[18];let M;e[19]===Symbol.for("react.memo_cache_sentinel")?(M=l=>te(l.target.value),e[19]=M):M=e[19];let f;e[20]!==o?(f=t.jsx("input",{type:"text",value:o,onChange:M,placeholder:"Search borrower...",className:"w-full border rounded-lg p-2 pr-10"}),e[20]=o,e[21]=f):f=e[21];let T;e[22]===Symbol.for("react.memo_cache_sentinel")?(T=t.jsx(je,{className:"absolute right-3 top-2.5 h-4 w-4 text-gray-500"}),e[22]=T):T=e[22];let h;e[23]!==f?(h=t.jsxs("div",{className:"relative",children:[f,T]}),e[23]=f,e[24]=h):h=e[24];let b;e[25]!==A||e[26]!==o.length?(b=o.length>0&&t.jsx("div",{className:"border rounded-lg mt-2 bg-white shadow max-h-32 overflow-y-auto",children:A.length>0?A.map(l=>t.jsx("div",{onClick:()=>be(l),className:"px-3 py-2 hover:bg-gray-100 cursor-pointer",children:l.name},l.id)):t.jsx("div",{className:"px-3 py-2 text-gray-500",children:"No results found"})}),e[25]=A,e[26]=o.length,e[27]=b):b=e[27];let p;e[28]!==h||e[29]!==b?(p=t.jsxs("div",{className:"col-span-2",children:[L,h,b]}),e[28]=h,e[29]=b,e[30]=p):p=e[30];let G;e[31]===Symbol.for("react.memo_cache_sentinel")?(G=t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Loan Number"}),e[31]=G):G=e[31];const re=d?.loanNo||"";let x;e[32]!==re?(x=t.jsxs("div",{children:[G,t.jsx("input",{type:"text",value:re,readOnly:!0,className:"w-full border rounded-lg p-2 bg-gray-100"})]}),e[32]=re,e[33]=x):x=e[33];let H;e[34]===Symbol.for("react.memo_cache_sentinel")?(H=t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Amount"}),e[34]=H):H=e[34];let O;e[35]===Symbol.for("react.memo_cache_sentinel")?(O=l=>{let r=parseFloat(l.target.value);isNaN(r)&&(r=0),r<0&&(r=0),r>1e7&&(r=1e7),ne(r.toString())},e[35]=O):O=e[35];let y;e[36]!==n?(y=t.jsxs("div",{children:[H,t.jsx("input",{type:"number",value:n,onChange:O,placeholder:"Enter amount",className:"w-full border rounded-lg p-2"})]}),e[36]=n,e[37]=y):y=e[37];let $;e[38]===Symbol.for("react.memo_cache_sentinel")?($=t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Payment Method"}),e[38]=$):$=e[38];let q;e[39]===Symbol.for("react.memo_cache_sentinel")?(q=l=>ce(l.target.value),e[39]=q):q=e[39];let z,I,J,K;e[40]===Symbol.for("react.memo_cache_sentinel")?(z=t.jsx("option",{value:"",children:"Select method"}),I=t.jsx("option",{value:"Cash",children:"Cash"}),J=t.jsx("option",{value:"Bank Transfer",children:"Bank Transfer"}),K=t.jsx("option",{value:"Gcash",children:"Gcash"}),e[40]=z,e[41]=I,e[42]=J,e[43]=K):(z=e[40],I=e[41],J=e[42],K=e[43]);let g;e[44]!==s?(g=t.jsxs("div",{children:[$,t.jsxs("select",{value:s,onChange:q,className:"w-full border rounded-lg p-2",children:[z,I,J,K]})]}),e[44]=s,e[45]=g):g=e[45];let j;e[46]!==s||e[47]!==a?(j=(s==="Gcash"||s==="Bank Transfer"||s==="Cash")&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Reference Number"}),t.jsx("input",{value:a,onChange:l=>de(l.target.value),placeholder:"Enter reference number",className:"w-full border rounded-lg p-2"})]}),e[46]=s,e[47]=a,e[48]=j):j=e[48];let Q;e[49]===Symbol.for("react.memo_cache_sentinel")?(Q=t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Collected By"}),e[49]=Q):Q=e[49];let U;e[50]===Symbol.for("react.memo_cache_sentinel")?(U=l=>ie(l.target.value),e[50]=U):U=e[50];let V;e[51]===Symbol.for("react.memo_cache_sentinel")?(V=t.jsx("option",{value:"",children:"Select collector"}),e[51]=V):V=e[51];let S;e[52]!==u?(S=u.map(ve),e[52]=u,e[53]=S):S=e[53];let v;e[54]!==i||e[55]!==S?(v=t.jsxs("div",{children:[Q,t.jsxs("select",{value:i,onChange:U,className:"w-full border rounded-lg p-2",children:[V,S]})]}),e[54]=i,e[55]=S,e[56]=v):v=e[56];let W;e[57]===Symbol.for("react.memo_cache_sentinel")?(W=t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Collection Date"}),e[57]=W):W=e[57];let X;e[58]===Symbol.for("react.memo_cache_sentinel")?(X=l=>me(l.target.value),e[58]=X):X=e[58];let N;e[59]!==m?(N=t.jsxs("div",{children:[W,t.jsx("input",{type:"date",value:m,onChange:X,className:"w-full border rounded-lg p-2"})]}),e[59]=m,e[60]=N):N=e[60];let _;e[61]!==p||e[62]!==x||e[63]!==y||e[64]!==g||e[65]!==j||e[66]!==v||e[67]!==N?(_=t.jsxs("section",{children:[D,t.jsxs("div",{className:"grid grid-cols-2 gap-x-8 gap-y-5",children:[p,x,y,g,j,v,N]})]}),e[61]=p,e[62]=x,e[63]=y,e[64]=g,e[65]=j,e[66]=v,e[67]=N,e[68]=_):_=e[68];let w;e[69]!==k?(w=k&&t.jsx("div",{className:"bg-green-100 text-green-800 p-3 rounded-md",children:k}),e[69]=k,e[70]=w):w=e[70];let Y;e[71]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsx("div",{className:"flex justify-end",children:t.jsx("button",{type:"submit",className:"px-6 py-2 text-black bg-[#FABF24] rounded-lg hover:bg-amber-600",children:"Submit Repayment"})}),e[71]=Y):Y=e[71];let Z;return e[72]!==se||e[73]!==_||e[74]!==w?(Z=t.jsxs(ge,{breadcrumbs:Se,children:[E,t.jsx("div",{className:"w-full h-full mx-auto bg-white shadow-lg rounded-2xl p-10 mb-16 border border-gray-100",children:t.jsxs("form",{onSubmit:se,className:"space-y-10",children:[_,w,Y]})})]}),e[72]=se,e[73]=_,e[74]=w,e[75]=Z):Z=e[75],Z}function ve(C){return t.jsx("option",{value:C.id,children:C.name},C.id)}export{He as default};
